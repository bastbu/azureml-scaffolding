{
    "name": "scaffolding",
    "build": {
      "dockerfile": "../Dockerfile",
      "target": "devcontainer"
    },
    "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",
    "hostRequirements": {
      "gpu": "optional"  // Ensure access to GPU if host has some
    },
    "runArgs": [
      "--ipc", "host"  // Needed for heavy torch training, harmless otherwise
    ],
    "remoteEnv": {
      // Ensure Poetry env is always first in PATH
      "PATH": "${containerWorkspaceFolder}/.venv/bin:${containerEnv:PATH}",
      // Allows imports directly on subfolders inside src
      "PYTHONPATH": "${containerWorkspaceFolder}/src"
    },
    "remoteUser": "vscode",
    "customizations": {
      "vscode": {
        "settings": {
          // Define ZSH as default shell for some quality of life goodies
          // Oh My Zsh comes with the base image
          "terminal.integrated.defaultProfile.linux": "zsh",
          "terminal.integrated.profiles.linux": { "zsh": { "path": "zsh" }}
        },
        "extensions": [
            "ms-python.python",
            "ms-toolsai.jupyter",
            "GitHub.copilot",
            "charliermarsh.ruff",
            "tamasfe.even-better-toml",
            "jeff-hykin.better-dockerfile-syntax"
        ]
      }
    },
    "features": {
      "ghcr.io/devcontainers/features/azure-cli:1": {
        "extensions": "ml"
      }
    },
    "postCreateCommand": "bin/repo/init"
  }